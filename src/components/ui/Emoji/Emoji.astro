---
const { emoji } = Astro.props;

const customEmojis = ["lesbian-flag", "t4t-flag", "t4t-flag-better"];

let imageUrl = ""

// https://twemoji.maxcdn.com/v/latest/twemoji.js
function toCodePoint(unicodeSurrogates: string, sep: string = "-") {
	let r = [],
		c = 0,
		p = 0,
		i = 0;
	while (i < unicodeSurrogates.length) {
		c = unicodeSurrogates.charCodeAt(i++);
		if (p) {
			r.push(
				(0x10000 + ((p - 0xd800) << 10) + (c - 0xdc00)).toString(
					16,
				),
			);
			p = 0;
		} else if (0xd800 <= c && c <= 0xdbff) {
			p = c;
		} else {
			r.push(c.toString(16));
		}
	}
	return r.join(sep);
}

if (customEmojis.includes(emoji)) {
	const emojiModule = await import("./custom-emojis/" +
		emoji.toLowerCase() + ".svg"
	);

	// imageUrl = "data:image/svg+xml;base64," + btoa(emojiModule.default);
	imageUrl = emojiModule.default;
} else {
	imageUrl =
		"https://twemoji.maxcdn.com/v/latest/svg/" +
		toCodePoint(emoji, "-") +
		".svg";
}
---

<style>
	img {
		display: inline;
		width: 1em;
		height: 1em;
		margin: 0 0.1em;
		margin-bottom: -0.15em;
		border-radius: 0;
	}
</style>
<img src={imageUrl} alt={emoji} />